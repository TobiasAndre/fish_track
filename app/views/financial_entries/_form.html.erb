<%= form_with model: @entry, class: "mt-6 space-y-4" do |f| %>
  <%= render "shared/form_errors", resource: @entry %>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div>
      <%= f.label :entry_type, "Tipo", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
      <%= f.select :entry_type, [["Saída", "expense"], ["Entrada", "income"]], {},
        class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
    </div>

    <div>
      <%= f.label :stage, "Fase", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
      <%= f.select :stage, [["Geral Sede", "general"], ["Juvenil", "juvenile"], ["Engorda", "growout"]], {},
        class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
    </div>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div>
      <%= f.label :occurred_on, "Data", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
      <%= f.date_field :occurred_on, class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                                            border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
    </div>

    <div data-controller="money-input">
      <%= f.label :amount_cents, "Valor (R$)", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>

      <input
        type="text"
        inputmode="decimal"
        autocomplete="off"
        placeholder="Ex: 200.000,00"
        data-money-input-target="display"
        data-action="input->money-input#input blur->money-input#blur"
        class="w-full rounded-lg border px-3 py-2 text-sm
              bg-white dark:bg-gray-950
              border-gray-300 dark:border-gray-700
              text-gray-900 dark:text-gray-100
              focus:outline-none focus:ring-2 focus:ring-indigo-500" />

      <%= f.hidden_field :amount_cents, data: { "money-input-target": "cents" } %>

      <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
        Você pode digitar: <span class="font-medium">200.000</span> ou <span class="font-medium">200.000,50</span>.
      </p>
    </div>
  </div>

  <div>
    <%= f.label :description, "Descrição", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
    <%= f.text_field :description, class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                                           border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div>
      <%= f.label :unit_id, "Unidade (opcional)", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
      <%= f.collection_select :unit_id, Unit.order(:name), :id, :name,
        { include_blank: true },
        class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
    </div>

    <div>
      <%= f.label :batch_id, "Lote (opcional)", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
      <%= f.collection_select :batch_id, Batch.order(started_on: :desc), :id, :name,
        { include_blank: true },
        class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
    </div>
  </div>

  <div>
    <%= f.label :notes, "Observações (opcional)", class: "block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1" %>
    <%= f.text_area :notes, rows: 3, class: "w-full rounded-lg border px-3 py-2 text-sm bg-white dark:bg-gray-950
                                            border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100" %>
  </div>

  <div class="flex gap-2">
    <%= f.submit "Salvar",
      class: "flex-1 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-400
              text-white font-medium py-2.5 rounded-lg transition" %>
    <%= link_to "Cancelar", financial_entries_path,
      class: "px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-700
              hover:bg-gray-50 dark:hover:bg-gray-800 transition" %>
  </div>
<% end %>
